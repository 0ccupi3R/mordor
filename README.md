# Mordor

This repository contains pre-recorded security events generated by simulated adversarial techniques in json format. Pre-recored data is categorized by operating system, tactics and techniques defined by the Mitre [ATT&CK Framework](https://attack.mitre.org/wiki/Main_Page). The name **Mordor** comes from the awesome film series "[The Lord of the Rings](https://en.wikipedia.org/wiki/The_Lord_of_the_Rings_(film_series))", and it was a place where the evil forces of [Sauron](https://en.wikipedia.org/wiki/Sauron) lived. This repository contains "malicious" pre-recorded activity, hence the name :wink: .

![alt text](resources/images/mordor-gate-main.jpg "Catapult")

# Goals

* Provide free portable malicious datasets to expedite the development of security analytics.
* Expedite red team simulation output consumption
* Improve the testing of hunting use cases in an easier and more affordable way.
* Enable data scientists to have semi-labeled data for initial research.
* Learn more about Kafkacat and Kafka

# Simulated Environment

| Platform | Version | Purpose | Count |
|---------|---------|---------|---------|
| Windows | Windows 2016 | Domain Controller | x1 |
| Windows | Windows 10 | Windows Endpoint | x 4 |
| MacOS | coming soon.. | coming soon.. | x0 |
| Kali Linux | Kali 2018.4 | Red Team Toolkit | x1 |

# Data Sources

| Platform | Data Source | Log Name | Configuration |
|---------|---------|---------|---------|
| Windows | Microsoft-Windows-Security-Auditing | Security | Windows-Security-WEF |
| Windows | Microsoft-Windows-Sysmon | Microsoft-windows-sysmon/operational | start_logging.xml |

# Data Consumption

You just need to clone this repo and start exploring the json files. You can simply just start grepping the files if you want. However, there are other ways you can consume the pre-recorded data and simulate a real data pipeline.

![alt text](resources/images/catapult-main-image.png "Catapult")

# Kafkacat Consumption

You can start using a tool named Kafkacat to act as a Kafka producer and send data to Kafka brokers. You can just grab the logs from this repo and re-play the data as if it was being ingested in real-time.

* [Kafka](http://kafka.apache.org/) : A distributed publish-subscribe messaging system that is designed to be fast, scalable, fault-tolerant, and durable.
* [Kafkacat](https://github.com/edenhill/kafkacat) : a generic non-JVM producer and consumer for Apache Kafka >=0.8, think of it as a netcat for Kafka.

![alt text](resources/images/kafka-kafkacat.png "Kafkacat Infrastructure")

## Kafkacat (non-docker)

You can install it by following the [instructions from the Kafkacat repo](https://github.com/edenhill/kafkacat#install). Pick your preferred file and run the following commands:

```
kafkacat -b <KAFKA-BROKER-NAME>:<KAFKA-BROKER-PORT> -t <KAFKA-TOPIC> -P -K: -l <JSON-FILE-INPUT.JSON>
```
## Kafkacat (docker)

If you want to use docker to run Kafkacat and send the data to a Kafka broker in a docker container, you need to install docker. You can use the script I provide with this repo:

```
git clone https://github.com/Cyb3rWard0g/mordor.git
cd scripts
sudo ./mordor_docker_install.sh
```

Pick your preferred file and run the following commands:

```
sudo docker run --rm -it --volume $PWD:/data --network <KAFKA-DOCKER-NETWORK> confluentinc/cp-kafkacat \
    kafkacat -b <KAFKA-BROKER-NAME>:<KAFKA-BROKER-PORT> -t <KAFKA-TOPIC> -P -K: -l /data/<JSON-FILE-INPUT.JSON>
```

# Author

* Roberto Rodriguez [@Cyb3rWard0g](https://twitter.com/Cyb3rWard0g)
* Jose Luis Rodriguez [@Cyb3rPandaH](https://twitter.com/Cyb3rPandaH)

# Contributors

# Contributing

There are a few things that I would like to accomplish with this repo as shown in the To-Do list below. If you want to share your pre-recorded data, make sure it follows the same format as the files provided in this repo.

# License: GPL-3.0

[ Mordor's GNU General Public License](https://github.com/Cyb3rWard0g/Mordor/blob/master/LICENSE)

# To-Do

[ ] MacOS & Linux pre-recorded events

More coming soon...