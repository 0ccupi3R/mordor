

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Mordor documentation &mdash; Mordor 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Available Networks" href="network_available.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> Mordor
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Mordor Environments:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="network_available.html">Available Networks</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mordor_categorization.html">Mordor Data Categorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="consume_mordor.html">Mordor Data Consumption</a></li>
</ul>
<p class="caption"><span class="caption-text">Licenses:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="license.html">GNU General Public License V3</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Mordor</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Mordor documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mordor-documentation">
<h1>Mordor documentation<a class="headerlink" href="#mordor-documentation" title="Permalink to this headline">¶</a></h1>
<p>The Mordor project provides pre-recorded security events generated by simulated adversarial techniques in the form of JavaScript Object Notation (JSON) files for easy consumption.
The pre-recorded data is categorized by platforms, adversary groups, tactics and techniques defined by the Mitre <a class="reference external" href="https://attack.mitre.org/wiki/Main_Page">ATT&amp;CK Framework</a>.
The pre-recorded data represents not only specific known malicious events but additional context/events that occur around it.
This is done on purpose so that you can test creative correlations across diverse data sources, enhancing your detection strategy and potentially reducing the number of false positives in your own environment.</p>
<p>The name <strong>Mordor</strong> comes from the awesome book/film series “<a class="reference external" href="https://en.wikipedia.org/wiki/The_Lord_of_the_Rings_(film_series)">The Lord of the Rings</a>”, and it was a place where the evil forces of <a class="reference external" href="https://en.wikipedia.org/wiki/Sauron">Sauron</a> lived.
This repository is where data generated by known “malicious” adversarial activity lives, hence the name of the project.</p>
<a class="reference internal image-reference" href="_images/mordor-gate-main.jpg"><img alt="Mordor Gates" src="_images/mordor-gate-main.jpg" style="width: 709.0999999999999px; height: 301.7px;" /></a>
<div class="section" id="goals">
<h2>Goals<a class="headerlink" href="#goals" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Provide free portable malicious datasets to expedite the development of data analytics.</li>
<li>Facilitate adversarial techniques simulation and output consumption.</li>
<li>Allow security analysts to test their skills with real known bad data.</li>
<li>Improve the testing of hunting use cases and data analytics in an easier and more affordable way.</li>
<li>Enable data scientists to have semi-labeled data for initial research.</li>
<li>Map threat hunter playbooks to their respective pre-recorded data for validation purposes.</li>
<li>Contribute to the <a class="reference external" href="https://attack.mitre.org/wiki/Main_Page">ATT&amp;CK framework</a> <strong>Data Sourcess</strong> section of each technique and sub-technique.</li>
<li>Ingest known bad data samples for training and capture the flag (CTF) events.</li>
<li>Learn more about red team simulation exercises and technology such as Kafkacat, Kafka and Jupyter Notebooks.</li>
</ul>
<div class="section" id="why-mordor">
<h3>Why Mordor?<a class="headerlink" href="#why-mordor" title="Permalink to this headline">¶</a></h3>
<p>Think about an attack that you want to test in your lab environment.
Let’s say we want to emulate an adversary using a non-domain-controller-account abusing the use of Active Directory replication services to optain the NTLM hash of user.
What do we do if we want to automate and expedite the emulation process? Usually the following might happen:</p>
<ul class="simple">
<li>Google for “DCSync” to look for the right script or red team simulation toolkit/project to execute the attack.</li>
<li>Find that it can be done via several programming languages and several tools out there.</li>
<li>Pick a “variant”. In this case let’s say we pick the Invoke-Mimikatz script from Powershell Empire.</li>
<li>Test the adversarial technique.</li>
<li>Document relevant data sources. At the endpoint level, the main behavior produces specific Windows Security events (Event ID 4662).</li>
<li>Consider other variants and try another way to accomplish the main adversarial objective.</li>
<li>Test another basic variant via another atomic red teaming toolkit. At the endpoint level, the main behavior produces the same Windows Security events (Events ID 4662).</li>
<li>Learn and test new ways to execute the adversarial technique (i.e .NET) and run it again.</li>
<li>At the endpoint level, the main behavior produces again the same Windows Security events (Events ID 4662).</li>
</ul>
<p>In my basic DCSync test I was using a user with replication permissions to initiate an ad replication operation.
The user name was <code class="docutils literal notranslate"><span class="pre">Mmidge</span></code>.
I was getting one of the following events:</p>
<a class="reference internal image-reference" href="_images/event-log-dcsync-one.png"><img alt="DCSync Log" src="_images/event-log-dcsync-one.png" style="width: 600.0px; height: 483.0px;" /></a>
</div>
</div>
<div class="section" id="what-is-going-on-here">
<h2>What is going on here?<a class="headerlink" href="#what-is-going-on-here" title="Permalink to this headline">¶</a></h2>
<p>Most of the time, depending on the detection goal, it does not matter what tool or programming language I use to emulate the adversarial technique or how many times I execute the attack, I still get the same event logic, pattern or relevant data.</p>
<p>From my basic example, I ask myself these question:</p>
<ul class="simple">
<li>What is my main goal?</li>
<li>Do I want to primarily detect .NET behavior or the behavior of a non-domain-controller account abusing ad replication services?.</li>
</ul>
<p>Do not get me wrong, the extra context of the execution method or the technique enabler is also valuable.
However, I believe that we can expedite the emulation of an adversarial technique by giving you the relevant data and pattern directly and go straight to the analysis phase of your threat detection strategy.</p>
</div>
<div class="section" id="do-i-get-only-the-events-related-to-the-adversarial-techniques">
<h2>Do I get only the events related to the adversarial techniques?<a class="headerlink" href="#do-i-get-only-the-events-related-to-the-adversarial-techniques" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>You get the potential relevant events and the extra context produced by other security events that get created during the time window of the log collection.</li>
<li>This is valuable if you want to explore other ways to enrich your data analytic and use extra context from events from different data sources.</li>
<li>For example, you also get events of the command and control communication from the endpoint which can then be mapped to the specific adversarial technique you are analyzing.</li>
<li>In addition, depending on the type of dataset you use, you get more context. Learn more about them in our <a class="reference external" href="https://mordor.readthedocs.io/en/latest/mordor_categorization.html">documentation here</a>.</li>
</ul>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Mordor Environments:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="network_available.html">Available Networks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="network_shire.html">The Shire</a></li>
</ul>
</li>
</ul>
</div>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mordor_categorization.html">Mordor Data Categorization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mordor_categorization.html#small-datasets">Small Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="mordor_categorization.html#large-datasets">Large Datasets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="consume_mordor.html">Mordor Data Consumption</a><ul>
<li class="toctree-l2"><a class="reference internal" href="consume_mordor.html#kafkacat-style">Kafkacat Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="consume_mordor.html#jupyter-notebook-style">Jupyter Notebook Style</a></li>
</ul>
</li>
</ul>
</div>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Licenses:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="license.html">GNU General Public License V3</a></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="network_available.html" class="btn btn-neutral float-right" title="Available Networks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Roberto Rodriguez, Jose Luis Rodriguez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>