

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Consume Mordor Datasets &#8212; Mordor Project</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/mystnb.js"></script>
    <script src="_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .secondtoggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script async="async" src="_static/thebelab.js"></script>
    <link rel="canonical" href="https://mordordatasets.com/import_mordor.html" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Mordor Events!" href="mordor_events.html" />
    <link rel="prev" title="Create Mordor Datasets" href="export_mordor.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">
<!-- Put requirejs at the end so it's always after bootstrap -->
<!-- TODO: remove this once https://github.com/pandas-dev/pydata-sphinx-theme/pull/149 is merged -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>


<!-- Opengraph tags -->
<meta property="og:url"         content="https://mordordatasets.com/import_mordor.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Consume Mordor Datasets" />
<meta property="og:description" content="Consume Mordor Datasets    You can simply download the json files available in this repo and start using some grep fu! if you feel like it. However, there are o" />
<meta property="og:image"       content="https://mordordatasets.com/_static/logo.png" />

<meta name="twitter:card" content="summary">


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          

<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Mordor Project</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
<li class="navbar-special">
<p class="margin-caption">Mordor Environments</p>
</li>
  <li class="">
    <a href="mordor_shire.html">The Shire</a>
  </li>
  <li class="">
    <a href="mordor_erebor.html">Erebor</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">How To</p>
</li>
  <li class="">
    <a href="export_mordor.html">Create Mordor Datasets</a>
  </li>
  <li class="active">
    <a href="">Consume Mordor Datasets</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Events</p>
</li>
  <li class="">
    <a href="mordor_events.html">Mordor Events!</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Small Mordor Datasets</p>
</li>
  <li class="">
    <a href="notebooks/small/windows/windows.html">Windows</a>
  </li>
  <li class="">
    <a href="notebooks/small/linux/linux.html">Linux</a>
  </li>
  <li class="">
    <a href="notebooks/small/mac/mac.html">MAC</a>
  </li>
</ul>
</nav>
<p class="navbar_footer">Powered by <a href="https://jupyterbook.org">Jupyter Book</a></p>
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="_sources/import_mordor.md.txt"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.md</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        <a class="edit-button" href="https://github.com/hunters-forge/mordor/edit/master/docs/import_mordor.md"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" title="Edit this page"><i class="fas fa-pencil-alt"></i></button></a>

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        

        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#kafkacat-style" class="nav-link">Kafkacat Style</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#requirements" class="nav-link">Requirements</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#consume-logs" class="nav-link">Consume Logs</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#jupyter-notebook-style" class="nav-link">Jupyter Notebook Style</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#suricata-style" class="nav-link">Suricata Style</a>
        </li>
    
    </ul>
</nav>



<div class="tocsection editthispage">
    <a href="https://github.com/hunters-forge/mordor/edit/master/docs/import_mordor.md">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 col-xxl-7 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="consume-mordor-datasets">
<h1>Consume Mordor Datasets<a class="headerlink" href="#consume-mordor-datasets" title="Permalink to this headline">¶</a></h1>
<p><img alt="" src="_images/catapult-main-image.png" /></p>
<p>You can simply download the json files available in this repo and start using some grep fu! if you feel like it.
However, there are other more efficient ways you can consume the pre-recorded data and even simulate a real data pipeline to ingest the data to your own SIEM or data lake.</p>
<div class="section" id="kafkacat-style">
<h2>Kafkacat Style<a class="headerlink" href="#kafkacat-style" title="Permalink to this headline">¶</a></h2>
<p>You can start using a tool named Kafkacat to act as a Kafka producer and send data to Kafka brokers.
In producer mode, Kafkacat reads messages from standard input (stdin) or a file.
This means that you can send data back to any other Kafka broker that you are using as part of your pipeline.
You can just grab the logs from this repo and re-play them as if they were being ingested in real-time.</p>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="http://kafka.apache.org/">Kafka Broker</a> : A distributed publish-subscribe messaging system that is designed to be fast, scalable, fault-tolerant, and durable  (<strong>Installed by HELK</strong>).</p></li>
<li><p><a class="reference external" href="https://github.com/edenhill/kafkacat">Kafkacat</a> : A generic non-JVM producer and consumer for Apache Kafka &gt;=0.8, think of it as a netcat for Kafka.</p></li>
<li><p><a class="reference external" href="https://www.elastic.co/elk-stack">HELK (Basic Option)</a>: An elastic ELK (Elasticsearch, Logstash, Kibana) stack.</p></li>
<li><p><a class="reference external" href="https://docs.docker.com/install/">Docker CE</a> : Docker Community Edition (CE) is ideal for developers and small teams looking to get started with Docker and experimenting with container-based apps (<strong>Installed by HELK</strong>).</p></li>
<li><p><a class="reference external" href="https://docs.docker.com/compose/">Docker Compose</a> : a tool for defining and running multi-container Docker applications (<strong>Installed by HELK</strong>).</p></li>
</ul>
<img src="images/kafka-kafkacat.png">
</div>
<div class="section" id="consume-logs">
<h3>Consume Logs<a class="headerlink" href="#consume-logs" title="Permalink to this headline">¶</a></h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/ADGWxofSf4o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Install Kafkacat following the <a class="reference external" href="https://github.com/edenhill/kafkacat#install">instructions from the official Kafkacat repo</a></p>
<ul class="simple">
<li><p>If you are using a debian-based system, make sure you install the latest Kafkacat deb package.</p></li>
<li><p>I recommend at least Ubuntu 18.04. You can check its <a class="reference external" href="https://packages.ubuntu.com/bionic/kafkacat">Kafkacat deb package version</a> and compare it with the latest one in the <a class="reference external" href="https://github.com/edenhill/kafkacat/releases">Kafkacat GitHub repo</a>.</p></li>
<li><p>If you are using Ubuntu 19, you might need to run the following commands (Thank you <a class="reference external" href="https://github.com/jwsy">Jason Yee</a>)</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">wget</span> <span class="pre">http://archive.ubuntu.com/ubuntu/pool/main/o/openssl1.0/libssl1.0.0_1.0.2n-1ubuntu6_amd64.deb</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">dpkg</span> <span class="pre">-i</span> <span class="pre">libssl1.0.0_1.0.2n-1ubuntu6_amd64.deb</span></code></p></li>
</ul>
</li>
<li><p>You can also install it from source following the <a class="reference external" href="https://github.com/edenhill/kafkacat#quick-build">Quick Build</a> instructions.</p></li>
</ul>
<p>Download and run the <a class="reference external" href="https://github.com/Cyb3rWard0g/HELK">HELK</a>. Make sure you have enough memory to run the basic build.
You can run it with 5-6GB of RAM now (More information <a class="reference external" href="https://github.com/Cyb3rWard0g/HELK/wiki/Installation">here</a>).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/Cyb3rWard0g/HELK.git
$ <span class="nb">cd</span> HELK/docker
$ sudo ./helk_install
</pre></div>
</div>
<p>Use the defaults (Option 1 and Basic license)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">**********************************************</span>
<span class="o">**</span>          <span class="n">HELK</span> <span class="o">-</span> <span class="n">THE</span> <span class="n">HUNTING</span> <span class="n">ELK</span>          <span class="o">**</span>
<span class="o">**</span>                                          <span class="o">**</span>
<span class="o">**</span> <span class="n">Author</span><span class="p">:</span> <span class="n">Roberto</span> <span class="n">Rodriguez</span> <span class="p">(</span><span class="nd">@Cyb3rWard0g</span><span class="p">)</span> <span class="o">**</span>
<span class="o">**</span> <span class="n">HELK</span> <span class="n">build</span> <span class="n">version</span><span class="p">:</span> <span class="n">v0</span><span class="o">.</span><span class="mf">1.7</span><span class="o">-</span><span class="n">alpha02262019</span> <span class="o">**</span>
<span class="o">**</span> <span class="n">HELK</span> <span class="n">ELK</span> <span class="n">version</span><span class="p">:</span> <span class="mf">6.6</span><span class="o">.</span><span class="mi">1</span>                  <span class="o">**</span>
<span class="o">**</span> <span class="n">License</span><span class="p">:</span> <span class="n">GPL</span><span class="o">-</span><span class="mf">3.0</span>                         <span class="o">**</span>
<span class="o">**********************************************</span>

<span class="p">[</span><span class="n">HELK</span><span class="o">-</span><span class="n">INSTALLATION</span><span class="o">-</span><span class="n">INFO</span><span class="p">]</span> <span class="n">HELK</span> <span class="n">being</span> <span class="n">hosted</span> <span class="n">on</span> <span class="n">a</span> <span class="n">Linux</span> <span class="n">box</span>
<span class="p">[</span><span class="n">HELK</span><span class="o">-</span><span class="n">INSTALLATION</span><span class="o">-</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Available</span> <span class="n">Memory</span><span class="p">:</span> <span class="mi">12541</span> <span class="n">MBs</span>
<span class="p">[</span><span class="n">HELK</span><span class="o">-</span><span class="n">INSTALLATION</span><span class="o">-</span><span class="n">INFO</span><span class="p">]</span> <span class="n">You</span><span class="s1">&#39;re using ubuntu version xenial</span>

<span class="o">*****************************************************</span>
<span class="o">*</span>      <span class="n">HELK</span> <span class="o">-</span> <span class="n">Docker</span> <span class="n">Compose</span> <span class="n">Build</span> <span class="n">Choices</span>          <span class="o">*</span>
<span class="o">*****************************************************</span>

<span class="mf">1.</span> <span class="n">KAFKA</span> <span class="o">+</span> <span class="n">KSQL</span> <span class="o">+</span> <span class="n">ELK</span> <span class="o">+</span> <span class="n">NGNIX</span> <span class="o">+</span> <span class="n">ELASTALERT</span>
<span class="mf">2.</span> <span class="n">KAFKA</span> <span class="o">+</span> <span class="n">KSQL</span> <span class="o">+</span> <span class="n">ELK</span> <span class="o">+</span> <span class="n">NGNIX</span> <span class="o">+</span> <span class="n">ELASTALERT</span> <span class="o">+</span> <span class="n">SPARK</span> <span class="o">+</span> <span class="n">JUPYTER</span>

<span class="n">Enter</span> <span class="n">build</span> <span class="n">choice</span> <span class="p">[</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]:</span> <span class="mi">1</span>
<span class="p">[</span><span class="n">HELK</span><span class="o">-</span><span class="n">INSTALLATION</span><span class="o">-</span><span class="n">INFO</span><span class="p">]</span> <span class="n">HELK</span> <span class="n">build</span> <span class="nb">set</span> <span class="n">to</span> <span class="mi">1</span>
<span class="p">[</span><span class="n">HELK</span><span class="o">-</span><span class="n">INSTALLATION</span><span class="o">-</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Set</span> <span class="n">HELK</span> <span class="n">elastic</span> <span class="n">subscription</span> <span class="p">(</span><span class="n">basic</span> <span class="ow">or</span> <span class="n">trial</span><span class="p">):</span> <span class="n">basic</span>
<span class="p">[</span><span class="n">HELK</span><span class="o">-</span><span class="n">INSTALLATION</span><span class="o">-</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Set</span> <span class="n">HELK</span> <span class="n">IP</span><span class="o">.</span> <span class="n">Default</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">your</span> <span class="n">current</span> <span class="n">IP</span><span class="p">:</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">64.138</span>
<span class="p">[</span><span class="n">HELK</span><span class="o">-</span><span class="n">INSTALLATION</span><span class="o">-</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Set</span> <span class="n">HELK</span> <span class="n">Kibana</span> <span class="n">UI</span> <span class="n">Password</span><span class="p">:</span> <span class="n">hunting</span>
<span class="p">[</span><span class="n">HELK</span><span class="o">-</span><span class="n">INSTALLATION</span><span class="o">-</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Verify</span> <span class="n">HELK</span> <span class="n">Kibana</span> <span class="n">UI</span> <span class="n">Password</span><span class="p">:</span> <span class="n">hunting</span>
<span class="p">[</span><span class="n">HELK</span><span class="o">-</span><span class="n">INSTALLATION</span><span class="o">-</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Installing</span> <span class="n">htpasswd</span><span class="o">..</span>
<span class="p">[</span><span class="n">HELK</span><span class="o">-</span><span class="n">INSTALLATION</span><span class="o">-</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Installing</span> <span class="n">docker</span> <span class="n">via</span> <span class="n">convenience</span> <span class="n">script</span><span class="o">..</span>
<span class="p">[</span><span class="n">HELK</span><span class="o">-</span><span class="n">INSTALLATION</span><span class="o">-</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Installing</span> <span class="n">docker</span><span class="o">-</span><span class="n">compose</span><span class="o">..</span>
<span class="p">[</span><span class="n">HELK</span><span class="o">-</span><span class="n">INSTALLATION</span><span class="o">-</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Checking</span> <span class="n">local</span> <span class="n">vm</span><span class="o">.</span><span class="n">max_map_count</span> <span class="n">variable</span> <span class="ow">and</span> <span class="n">setting</span> <span class="n">it</span> <span class="n">to</span> <span class="mi">4120294</span>
<span class="p">[</span><span class="n">HELK</span><span class="o">-</span><span class="n">INSTALLATION</span><span class="o">-</span><span class="n">INFO</span><span class="p">]</span> <span class="n">Building</span> <span class="o">&amp;</span> <span class="n">running</span> <span class="n">HELK</span> <span class="kn">from</span> <span class="nn">helk</span><span class="o">-</span><span class="n">kibana</span><span class="o">-</span><span class="n">analysis</span><span class="o">-</span><span class="n">basic</span><span class="o">.</span><span class="n">yml</span> <span class="n">file</span><span class="o">..</span>
</pre></div>
</div>
<p>Download the mordor repo and choose your technique:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> ../../
$ git clone https://github.com/Cyb3rWard0g/mordor.git
$ <span class="nb">cd</span> mordor/small_datasets/windows/credential_access/credential_dumping_T1003/credentials_from_ad/
</pre></div>
</div>
<p>Decompress the specific mordor log file</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ tar -xzvf empire_dcsync.tar.gz
x empire_dcsync_2019-03-01174830.json
</pre></div>
</div>
<p>Send the data to HELK via Kafcakat with the following flags:</p>
<ul class="simple">
<li><p><strong>-b</strong>: Kafka Broker</p></li>
<li><p><strong>-t</strong>: Topic in the Kafka Broker to send the data to</p></li>
<li><p><strong>-P</strong>: Producer mode</p></li>
<li><p><strong>-l</strong>: Send messages from a file separated by delimiter, as with stdin. (only one file allowed)</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ kafkacat -b &lt;HELK IP&gt;:9092 -t winlogbeat -P -l empire_dcsync_2019-03-01174830.json
</pre></div>
</div>
<p>Browse to your Kibana Discover view and start going through the data</p>
<p><img alt="" src="_images/mordor-dcsync-logs.png" /></p>
<p>You could look for potential DCSync actvity from a non-Domain-Controller account with the following query in Kibana:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>event_id:4662 NOT user_name:*$ AND object_properties:<span class="o">(</span><span class="s2">&quot;*1131f6aa-9c07-11d1-f79f-00c04fc2dcd2*&quot;</span> OR <span class="s2">&quot;*1131f6ad-9c07-11d1-f79f-00c04fc2dcd2*&quot;</span> OR <span class="s2">&quot;*89e95b76-444d-4c62-991a-0facbeda640c*&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p><img alt="" src="_images/mordor-dcsync-found.png" /></p>
</div>
</div>
<div class="section" id="jupyter-notebook-style">
<h2>Jupyter Notebook Style<a class="headerlink" href="#jupyter-notebook-style" title="Permalink to this headline">¶</a></h2>
<p>You can consume mordor data directly with a Jupyter notebook and analyze it via python libraries such as Pandas or PySpark.</p>
</div>
<div class="section" id="suricata-style">
<h2>Suricata Style<a class="headerlink" href="#suricata-style" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Install Suricata (OSX)</p></li>
</ul>
<p>https://redmine.openinfosecfoundation.org/projects/suricata/wiki/Mac_OS_X_10_11</p>
<ul class="simple">
<li><p>Download open Emerging Threat rules</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget https://rules.emergingthreats.net/open/suricata/emerging.rules.zip
tar zxvf emerging.rules.tar.gz
sudo mkdir /var/lib/suricata/
sudo mv rules /var/lib/suricata/
</pre></div>
</div>
<ul class="simple">
<li><p>Update Suricata config to point to that folder <code class="docutils literal notranslate"><span class="pre">/etc/suricata/suricata.yaml</span></code></p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">default</span><span class="o">-</span><span class="n">rule</span><span class="o">-</span><span class="n">path</span><span class="p">:</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">suricata</span><span class="o">/</span><span class="n">rules</span>

<span class="n">rule</span><span class="o">-</span><span class="n">files</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">emerging</span><span class="o">*</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Clone Project and change directories</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/hunters-forge/mordor <span class="o">&amp;&amp;</span> <span class="nb">cd</span> mordor/datasets/large
</pre></div>
</div>
<ul class="simple">
<li><p>Decompress every PCAP in the same folder (Password Protected: <code class="docutils literal notranslate"><span class="pre">infected</span></code>)</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>find apt29/day*/pcaps -name <span class="s1">&#39;*.zip&#39;</span> -execdir unzip -P infected <span class="o">{}</span> <span class="se">\;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Run Suricata on every single PCAP and append results from every PCAP to <code class="docutils literal notranslate"><span class="pre">fast.log</span></code> and <code class="docutils literal notranslate"><span class="pre">eve.json</span></code> files in their respective directories.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>find apt29/day*/pcaps -name <span class="s1">&#39;*cap&#39;</span> -execdir suricata -r <span class="o">{}</span> -k none <span class="se">\;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Stack count the alers generated</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>jq <span class="s1">&#39;select((.event_type == &quot;alert&quot;) and .alert.category != &quot;Generic Protocol Command Decode&quot;) | .alert.signature&#39;</span> apt29/day1/pcaps/eve.json <span class="p">|</span> sort <span class="p">|</span> uniq -c
</pre></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "hunters-forge/mordor",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "."
        }
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="export_mordor.html" title="previous page">Create Mordor Datasets</a>
    <a class='right-next' id="next-link" href="mordor_events.html" title="next page">Mordor Events!</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2020.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.1.<br/>
    </p>
  </div>
</footer>
</main>


      </div>
    </div>

    <script src="_static/js/index.js"></script>
    
  </body>
</html>